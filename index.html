<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Bible Reader - Full Year Plan</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Merriweather:wght@400;700&display=swap');

        :root {
            --primary-color: #3E64FF;
            --secondary-color: #5A31F4;
            --success-color: #2ECC71;
            --warning-color: #F4D03F;
            --background-light: #FFFFFF;
            --background-card: #F9F9F9;
            --text-dark: #333333;
            --text-medium: #666666;
            --border-color: #E0E0E0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: var(--text-dark);
            max-width: 480px;
            margin: 0 auto;
            position: relative;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        .app-container {
            background-color: var(--background-light);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header Styles */
        .header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--background-light);
            border-bottom: 1px solid var(--border-color);
        }

        .header-left {
            flex: 1;
        }

        .greeting {
            font-size: 14px;
            color: var(--text-medium);
        }

        .user-name {
            font-size: 24px;
            font-weight: bold;
            margin: 4px 0;
        }

        .date {
            font-size: 14px;
            color: var(--text-medium);
        }

        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
        }

        /* Progress Card */
        .progress-card {
            margin: 16px;
            background-color: var(--background-light);
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .progress-content {
            display: flex;
            align-items: center;
        }

        .progress-circle {
            position: relative;
            width: 80px;
            height: 80px;
        }

        .progress-circle svg {
            transform: rotate(-90deg);
        }

        .progress-circle-bg {
            fill: none;
            stroke: #E0E0E0;
            stroke-width: 8;
        }

        .progress-circle-fill {
            fill: none;
            stroke: var(--primary-color);
            stroke-width: 8;
            stroke-linecap: round;
            transition: stroke-dasharray 0.3s ease;
        }

        .progress-text {
            margin-left: 20px;
            flex: 1;
        }

        .progress-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .progress-subtitle {
            color: var(--text-medium);
            font-size: 16px;
        }

        /* Reading Cards */
        .reading-card {
            margin: 0 16px 16px 16px;
            background-color: var(--background-light);
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .reading-card.completed {
            border-left: 5px solid var(--success-color);
        }

        .reading-content {
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .reading-left {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .reading-icon {
            margin-right: 12px;
            width: 32px;
            height: 32px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--primary-color);
        }

        .completed .reading-icon {
            color: var(--success-color);
        }

        .reading-text {
            flex: 1;
        }

        .reading-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .reading-reference {
            font-size: 14px;
            margin-bottom: 4px;
        }

        .reading-time {
            font-size: 12px;
            color: var(--text-medium);
        }

        .reading-checkbox {
            width: 22px;
            height: 22px;
            border-radius: 4px;
            border: 2px solid var(--primary-color);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .reading-checkbox.checked {
            background-color: var(--success-color);
            border-color: var(--success-color);
            color: white;
        }

        .reading-actions {
            padding: 12px 16px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            border: none;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        /* Stats Container */
        .stats-container {
            display: flex;
            justify-content: space-around;
            padding: 16px;
            background-color: var(--background-light);
            margin: 0 16px 16px 16px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-medium);
            margin-top: 4px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 12px 0;
            background-color: var(--background-light);
            position: fixed;
            bottom: 0;
            width: 100%;
            max-width: 480px;
            border-top: 1px solid var(--border-color);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px 0;
            cursor: pointer;
            flex: 1;
        }

        .nav-item i {
            font-size: 20px;
            margin-bottom: 4px;
            color: var(--text-medium);
        }

        .nav-item.active i {
            color: var(--primary-color);
        }

        .nav-label {
            font-size: 12px;
            color: var(--text-medium);
        }

        .nav-item.active .nav-label {
            color: var(--primary-color);
        }

        /* Main Content Area */
        .main-content {
            flex: 1;
            margin-bottom: 70px; /* Space for bottom nav */
            overflow-y: auto;
        }

        /* Bible Reader Styles */
        .reader-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background-color: var(--primary-color);
            color: white;
        }

        .reader-title {
            font-size: 18px;
            font-weight: 600;
        }

        .reader-content {
            padding: 20px;
            font-family: 'Merriweather', serif;
            line-height: 1.6;
        }

        .chapter-number {
            font-size: 32px;
            font-weight: bold;
            color: var(--text-medium);
            margin-bottom: 16px;
        }

        .verse-wrapper {
            margin-bottom: 16px;
        }

        .verse-number {
            font-size: 12px;
            vertical-align: super;
            color: var(--text-medium);
            margin-right: 4px;
        }

        .verse-text {
            font-size: 16px;
        }

        .reader-footer {
            padding: 16px;
            border-top: 1px solid var(--border-color);
            position: fixed;
            bottom: 0;
            width: 100%;
            max-width: 480px;
            background-color: white;
            display: flex;
            justify-content: flex-end;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        /* Calendar Screen Styles */
        .calendar-container {
            margin: 16px;
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background-color: var(--primary-color);
            color: white;
        }

        .calendar-title {
            font-size: 18px;
            font-weight: 600;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            padding: 16px;
        }

        .calendar-day-header {
            text-align: center;
            font-weight: 600;
            font-size: 14px;
            color: var(--text-medium);
            padding-bottom: 8px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            position: relative;
            cursor: pointer;
            font-size: 14px;
        }

        .calendar-day.active-month {
            color: var(--text-dark);
        }
        
        .calendar-day.inactive-month {
            color: #ccc;
        }

        .calendar-day.today {
            background-color: rgba(62, 100, 255, 0.1);
            font-weight: bold;
        }

        .calendar-day.selected {
            background-color: var(--primary-color);
            color: white !important;
        }

        .calendar-day.completed {
            position: relative;
        }

        .calendar-day.completed::after {
            content: '';
            position: absolute;
            bottom: 2px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: var(--success-color);
        }

        .calendar-day.partial::after {
            content: '';
            position: absolute;
            bottom: 2px;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: var(--warning-color);
        }

        .date-info-card {
            margin: 16px;
            background-color: white;
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .date-title {
            font-size: 18px;
            font-weight: 600;
            text-align: center;
        }

        /* Screen Hiding Logic */
        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }
        
        /* Transition Animation */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .screen.active {
            animation: fadeIn 0.3s ease;
        }
        
        /* Settings Screen Styles */
        .settings-group {
            margin: 16px;
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }
        
        .settings-header {
            padding: 12px 16px;
            font-weight: 600;
            color: var(--text-medium);
            background-color: #f9f9f9;
            border-bottom: 1px solid var(--border-color);
        }
        
        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .settings-item:last-child {
            border-bottom: none;
        }
        
        .settings-left {
            display: flex;
            align-items: center;
        }
        
        .settings-icon {
            width: 24px;
            text-align: center;
            margin-right: 16px;
            color: var(--primary-color);
        }
        
        .settings-text {
            font-size: 16px;
        }
        
        .settings-description {
            font-size: 14px;
            color: var(--text-medium);
            margin-top: 4px;
        }
        
        .toggle {
            position: relative;
            width: 50px;
            height: 24px;
        }
        
        .toggle input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: var(--success-color);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        /* Date picker styles */
        .date-picker {
            text-align: center;
            margin-bottom: 16px;
        }
        
        .date-picker select {
            padding: 8px;
            margin: 0 4px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            width: 80%;
            max-width: 300px;
        }
        
        /* Navigation buttons in the calendar */
        .calendar-nav-btn {
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            padding: 8px;
        }
        
        /* No readings message */
        .no-readings {
            padding: 20px;
            text-align: center;
            color: var(--text-medium);
        }

        /* User info form in settings */
        .settings-input {
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            margin-top: 8px;
            width: 100%;
        }

        /* Monthly progress styles */
        .month-progress {
            padding: 10px 16px;
            display: flex;
            flex-direction: column;
            background-color: #fff;
            margin: 0 16px 16px 16px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .month-progress-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-medium);
        }

        .month-progress-bar {
            height: 6px;
            background-color: #e0e0e0;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .month-progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .month-stats {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-medium);
        }

        .loading-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: var(--text-medium);
        }

        .loading-indicator i {
            margin-right: 8px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* External link button styling */
        .external-link-btn {
            background-color: #f0f0f0;
            color: var(--text-dark);
            border: 1px solid #ddd;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Home Screen -->
        <div id="home-screen" class="screen active">
            <div class="header">
                <div class="header-left">
                    <div class="greeting" id="greeting-text">Good morning,</div>
                    <div class="user-name" id="user-name-display">Reader</div>
                    <div class="date" id="current-date"></div>
                </div>
                <div class="avatar" id="user-avatar">R</div>
            </div>
            
            <div class="main-content">
                <div class="date-picker">
                    <select id="day-selector" onchange="changeDate()">
                        <!-- Will be populated by JavaScript -->
                        <option value="loading">Loading reading plan...</option>
                    </select>
                </div>
                
                <div class="progress-card">
                    <div class="progress-content">
                        <div class="progress-circle">
                            <svg width="80" height="80" xmlns="http://www.w3.org/2000/svg">
                                <circle class="progress-circle-bg" cx="40" cy="40" r="36"></circle>
                                <circle class="progress-circle-fill" cx="40" cy="40" r="36" stroke-dasharray="0 226.2"></circle>
                            </svg>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 20px; font-weight: bold;">0/3</div>
                        </div>
                        <div class="progress-text">
                            <div class="progress-title">Today's Readings</div>
                            <div class="progress-subtitle">Start your daily readings</div>
                        </div>
                    </div>
                </div>
                
                <div id="reading-container">
                    <div class="loading-indicator">
                        <i class="fas fa-spinner"></i> Loading readings...
                    </div>
                </div>
                
                <div class="month-progress">
                    <div class="month-progress-title">March Progress</div>
                    <div class="month-progress-bar">
                        <div class="month-progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="month-stats">
                        <div class="month-completed">0 readings completed</div>
                        <div class="month-total">0 of 0 readings (0%)</div>
                    </div>
                </div>
                
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-value" id="streak-count">0</div>
                        <div class="stat-label">Day Streak</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="total-readings">0</div>
                        <div class="stat-label">Total Readings</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="completed-days">0</div>
                        <div class="stat-label">Days Complete</div>
                    </div>
                </div>
            </div>
            
            <div class="bottom-nav">
                <div class="nav-item active" onclick="showScreen('home-screen')">
                    <i class="fas fa-home"></i>
                    <div class="nav-label">Home</div>
                </div>
                <div class="nav-item" onclick="showScreen('calendar-screen')">
                    <i class="fas fa-calendar-alt"></i>
                    <div class="nav-label">Calendar</div>
                </div>
                <div class="nav-item" onclick="showScreen('settings-screen')">
                    <i class="fas fa-cog"></i>
                    <div class="nav-label">Settings</div>
                </div>
            </div>
        </div>
        
        <!-- Bible Reader Screen -->
        <div id="reader-screen" class="screen">
            <div class="reader-header">
                <i class="fas fa-arrow-left" onclick="showScreen('home-screen')"></i>
                <div class="reader-title" id="reader-title">Scripture Reference</div>
                <i class="fas fa-font"></i>
            </div>
            
            <div class="main-content">
                <div class="reader-content" id="reader-content">
                    <!-- Scripture content will be loaded here by JavaScript -->
                    <div class="loading-indicator">
                        <i class="fas fa-spinner"></i> Loading scripture...
                    </div>
                </div>
            </div>
            
            <div class="reader-footer">
                <button class="btn external-link-btn" id="external-link-btn" onclick="openExternalBible()">
                    <i class="fas fa-external-link-alt"></i> Open in Bible App
                </button>
                <button class="btn btn-success" id="mark-complete-btn" onclick="markReaderComplete()">
                    <i class="fas fa-check"></i> Mark Complete
                </button>
            </div>
        </div>
        
        <!-- Calendar Screen -->
        <div id="calendar-screen" class="screen">
            <div class="header">
                <div class="header-left">
                    <div class="greeting">Calendar</div>
                    <div class="user-name">Bible Reading Plan</div>
                </div>
                <div class="avatar" id="calendar-user-avatar">R</div>
            </div>
            
            <div class="main-content">
                <div class="calendar-container">
                    <div class="calendar-header">
                        <button class="calendar-nav-btn" onclick="changeMonth(-1)">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <div class="calendar-title" id="calendar-month-title">March 2025</div>
                        <button class="calendar-nav-btn" onclick="changeMonth(1)">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    
                    <div class="calendar-grid" id="calendar-grid">
                        <!-- Calendar will be populated here by JavaScript -->
                        <div class="loading-indicator">
                            <i class="fas fa-spinner"></i> Loading calendar...
                        </div>
                    </div>
                </div>
                
                <div class="date-info-card">
                    <div class="date-title" id="calendar-date-title">Monday, March 17, 2025</div>
                </div>
                
                <div id="calendar-reading-container">
                    <!-- Calendar readings will be populated here by JavaScript -->
                    <div class="loading-indicator">
                        <i class="fas fa-spinner"></i> Loading readings...
                    </div>
                </div>
            </div>
            
            <div class="bottom-nav">
                <div class="nav-item" onclick="showScreen('home-screen')">
                    <i class="fas fa-home"></i>
                    <div class="nav-label">Home</div>
                </div>
                <div class="nav-item active" onclick="showScreen('calendar-screen')">
                    <i class="fas fa-calendar-alt"></i>
                    <div class="nav-label">Calendar</div>
                </div>
                <div class="nav-item" onclick="showScreen('settings-screen')">
                    <i class="fas fa-cog"></i>
                    <div class="nav-label">Settings</div>
                </div>
            </div>
        </div>
        
        <!-- Settings Screen -->
        <div id="settings-screen" class="screen">
            <div class="header">
                <div class="header-left">
                    <div class="greeting">Settings</div>
                    <div class="user-name">Customize Your Experience</div>
                </div>
                <div class="avatar" id="settings-user-avatar">R</div>
            </div>
            
            <div class="main-content">
                <div class="settings-group">
                    <div class="settings-header">Account</div>
                    
                    <div class="settings-item">
                        <div class="settings-left">
                            <div class="settings-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <div>
                                <div class="settings-text">Display Name</div>
                                <input type="text" id="display-name-input" class="settings-input" value="Reader" placeholder="Your name">
                            </div>
                        </div>
                        <button id="save-profile" class="btn btn-primary" onclick="saveUserProfile()">Save</button>
                    </div>
                </div>
                
                <div class="settings-group">
                    <div class="settings-header">Notifications</div>
                    
                    <div class="settings-item">
                        <div class="settings-left">
                            <div class="settings-icon">
                                <i class="fas fa-bell"></i>
                            </div>
                            <div class="settings-text">Daily Reminder</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="notifications-toggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="settings-item">
                        <div class="settings-left">
                            <div class="settings-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div>
                                <div class="settings-text">Reminder Time</div>
                                <input type="time" id="reminder-time" class="settings-input" value="08:00">
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="saveReminderSettings()">Save</button>
                    </div>
                </div>
                
                <div class="settings-group">
                    <div class="settings-header">Appearance</div>
                    
                    <div class="settings-item">
                        <div class="settings-left">
                            <div class="settings-icon">
                                <i class="fas fa-moon"></i>
                            </div>
                            <div class="settings-text">Dark Mode</div>
                        </div>
                        <label class="toggle">
                            <input type="checkbox" id="dark-mode-toggle">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="settings-item">
                        <div class="settings-left">
                            <div class="settings-icon">
                                <i class="fas fa-font"></i>
                            </div>
                            <div class="settings-text">Text Size</div>
                        </div>
                        <select id="text-size-selector" class="settings-input" style="width:auto; margin-top:0;">
                            <option value="small">Small</option>
                            <option value="medium" selected>Medium</option>
                            <option value="large">Large</option>
                        </select>
                    </div>
                </div>
                
                <div class="settings-group">
                    <div class="settings-header">Data Management</div>
                    
                    <div class="settings-item">
                        <div class="settings-left">
                            <div class="settings-icon">
                                <i class="fas fa-sync"></i>
                            </div>
                            <div class="settings-text">Reset Reading Progress</div>
                        </div>
                        <button class="btn btn-primary" onclick="resetProgress()">Reset</button>
                    </div>
                </div>
                
                <div class="settings-group">
                    <div class="settings-header">About</div>
                    
                    <div class="settings-item">
                        <div class="settings-left">
                            <div class="settings-icon">
                                <i class="fas fa-info-circle"></i>
                            </div>
                            <div>
                                <div class="settings-text">App Version</div>
                                <div class="settings-description">1.0.0</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="bottom-nav">
                <div class="nav-item" onclick="showScreen('home-screen')">
                    <i class="fas fa-home"></i>
                    <div class="nav-label">Home</div>
                </div>
                <div class="nav-item" onclick="showScreen('calendar-screen')">
                    <i class="fas fa-calendar-alt"></i>
                    <div class="nav-label">Calendar</div>
                </div>
                <div class="nav-item active" onclick="showScreen('settings-screen')">
                    <i class="fas fa-cog"></i>
                    <div class="nav-label">Settings</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Bible reading plan data from JSON
        const rawReadingPlanData = [
            {
              "Reading Day": 1,
              "Short Date": "3/17/25",
              "Long Date": "Monday, March 17, 2025",
              "Date": "2025-03-17",
              "Reading 1": "Genesis 1, Genesis 2:1-17",
              "Reading 2": "Matthew 1:1-25",
              "Reading 3": "Psalm 1:1-6"
            },
            {
              "Reading Day": 2,
              "Short Date": "3/18/25",
              "Long Date": "Tuesday, March 18, 2025",
              "Date": "2025-03-18",
              "Reading 1": "Genesis 2:18-25, Genesis 3, Genesis 4:1-16",
              "Reading 2": "Matthew 2:1-18",
              "Reading 3": "Psalm 2:1-12"
            },
            {
              "Reading Day": 3,
              "Short Date": "3/19/25",
              "Long Date": "Wednesday, March 19, 2025",
              "Date": "2025-03-19",
              "Reading 1": "Genesis 4:17-26, Genesis 5, Genesis 6",
              "Reading 2": "Matthew 2:19-23, Matthew 3",
              "Reading 3": "Psalm 3:1-8"
            },
            {
              "Reading Day": 4,
              "Short Date": "3/20/25",
              "Long Date": "Thursday, March 20, 2025",
              "Date": "2025-03-20",
              "Reading 1": "Genesis 7, Genesis 8, Genesis 9:1-17",
              "Reading 2": "Matthew 4:1-22",
              "Reading 3": "Proverbs 1:1-7"
            },
            {
              "Reading Day": 5,
              "Short Date": "3/21/25",
              "Long Date": "Friday, March 21, 2025",
              "Date": "2025-03-21",
              "Reading 1": "Genesis 9:18-29, Genesis 10, Genesis 11:1-9",
              "Reading 2": "Matthew 4:23-25, Matthew 5:1-20",
              "Reading 3": "Psalm 4:1-8"
            },
            {
              "Reading Day": 6,
              "Short Date": "3/22/25",
              "Long Date": "Saturday, March 22, 2025",
              "Date": "2025-03-22",
              "Reading 1": "Genesis 11:10-32, Genesis 12, Genesis 13",
              "Reading 2": "Matthew 5:21-42",
              "Reading 3": "Psalm 5:1-12"
            },
            {
              "Reading Day": 7,
              "Short Date": "3/23/25",
              "Long Date": "Sunday, March 23, 2025",
              "Date": "2025-03-23",
              "Reading 1": "Genesis 14, Genesis 15, Genesis 16",
              "Reading 2": "Matthew 5:43-48, Matthew 6:1-24",
              "Reading 3": "Psalm 6"
            }
            // In a real app, we'd have all 365 days loaded
        ];
        
        // Sample verse content for demo (normally would come from a Bible API)
        const sampleVerses = {
            "Genesis 1": [
                { number: 1, text: "In the beginning God created the heaven and the earth." },
                { number: 2, text: "And the earth was without form, and void; and darkness was upon the face of the deep. And the Spirit of God moved upon the face of the waters." },
                { number: 3, text: "And God said, Let there be light: and there was light." },
                { number: 4, text: "And God saw the light, that it was good: and God divided the light from the darkness." },
                { number: 5, text: "And God called the light Day, and the darkness he called Night. And the evening and the morning were the first day." }
            ],
            "Matthew 1": [
                { number: 1, text: "The book of the generation of Jesus Christ, the son of David, the son of Abraham." },
                { number: 2, text: "Abraham begat Isaac; and Isaac begat Jacob; and Jacob begat Judas and his brethren;" },
                { number: 3, text: "And Judas begat Phares and Zara of Thamar; and Phares begat Esrom; and Esrom begat Aram;" }
            ],
            "Psalm 1": [
                { number: 1, text: "Blessed is the man that walketh not in the counsel of the ungodly, nor standeth in the way of sinners, nor sitteth in the seat of the scornful." },
                { number: 2, text: "But his delight is in the law of the LORD; and in his law doth he meditate day and night." },
                { number: 3, text: "And he shall be like a tree planted by the rivers of water, that bringeth forth his fruit in his season; his leaf also shall not wither; and whatsoever he doeth shall prosper." }
            ]
        };
        
        // Convert raw reading plan data to the app format
        const readingPlan = {};
        rawReadingPlanData.forEach(day => {
            const date = day.Date;
            readingPlan[date] = {
                date: day["Long Date"],
                shortDate: day["Short Date"],
                readingDay: day["Reading Day"],
                readings: [
                    {
                        type: "oldTestament",
                        title: "Old Testament",
                        reference: day["Reading 1"],
                        icon: "book",
                        time: estimateReadingTime(day["Reading 1"]),
                        completed: false
                    },
                    {
                        type: "newTestament",
                        title: "New Testament",
                        reference: day["Reading 2"],
                        icon: "cross",
                        time: estimateReadingTime(day["Reading 2"]),
                        completed: false
                    },
                    {
                        type: "psalmsProverbs",
                        title: "Psalms & Proverbs",
                        reference: day["Reading 3"],
                        icon: "music",
                        time: estimateReadingTime(day["Reading 3"]),
                        completed: false
                    }
                ]
            };
        });
        
        // App state
        let currentDate = "2025-03-17"; // Default starting day
        let currentMonth = 2; // March (0-based index)
        let currentYear = 2025;
        let currentReadingIndex = -1;
        
        // User stats
        let userStats = {
            streak: 0,
            totalReadings: 0,
            completedDays: 0
        };
        
        // User settings
        let userSettings = {
            name: "Reader",
            notificationsEnabled: true,
            reminderTime: "08:00",
            darkMode: false,
            textSize: "medium"
        };
        
        // Initialize the app when DOM content is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Load user preferences
            loadUserProfile();
            
            // Set current date in header
            updateDateDisplay();
            
            // Initialize the day selector dropdown
            initializeDaySelector();
            
            // Render initial readings and calendar
            renderReadings('reading-container', currentDate);
            renderCalendar();
            
            // Update progress indicators
            updateProgress();
            updateMonthProgress();
        });
        
        // Helper function to estimate reading time based on reference length
        function estimateReadingTime(reference) {
            // Simple estimation - could be improved with actual verse counts
            const commaCount = (reference.match(/,/g) || []).length;
            const minutes = Math.max(3, commaCount + 3);
            return `${minutes} min`;
        }
        
        // Format the current date for display
        function updateDateDisplay() {
            const today = new Date();
            document.getElementById('current-date').textContent = formatDate(today);
            
            // Set appropriate greeting based on time of day
            const greeting = getTimeOfDayGreeting();
            document.getElementById('greeting-text').textContent = greeting + ',';
        }
        
        // Get time-of-day appropriate greeting
        function getTimeOfDayGreeting() {
            const hour = new Date().getHours();
            if (hour < 12) return 'Good morning';
            if (hour < 18) return 'Good afternoon';
            return 'Good evening';
        }
        
        // Format a date object to string
        function formatDate(date) {
            const options = { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        }
        
        // Initialize the day selector dropdown
        function initializeDaySelector() {
            const selector = document.getElementById('day-selector');
            selector.innerHTML = '';
            
            // Add options for each day in the reading plan
            Object.keys(readingPlan).forEach(date => {
                const day = readingPlan[date];
                const option = document.createElement('option');
                option.value = date;
                option.textContent = `Day ${day.readingDay}: ${day.shortDate}`;
                if (date === currentDate) {
                    option.selected = true;
                }
                selector.appendChild(option);
            });
        }
        
        // Calculate and set progress circle
        function setProgressCircle(percentage) {
            const circle = document.querySelector('.progress-circle-fill');
            const radius = 36;
            const circumference = 2 * Math.PI * radius;
            
            const fillPercentage = (percentage / 100) * circumference;
            const emptyPercentage = circumference - fillPercentage;
            
            circle.style.strokeDasharray = `${fillPercentage} ${emptyPercentage}`;
        }
        
        // Update progress based on completed readings
        function updateProgress() {
            const dayData = readingPlan[currentDate];
            if (!dayData) return;
            
            const total = dayData.readings.length;
            const completed = dayData.readings.filter(reading => reading.completed).length;
            
            // Update circle
            setProgressCircle((completed / total) * 100);
            
            // Update text
            document.querySelector('.progress-circle > div').textContent = `${completed}/${total}`;
            
            // Update subtitle
            const subtitle = document.querySelector('.progress-subtitle');
            if (completed === 0) {
                subtitle.textContent = "Start your daily readings";
            } else if (completed === total) {
                subtitle.textContent = "Great job! All readings complete.";
            } else {
                subtitle.textContent = `${completed}/${total} readings completed`;
            }
            
            // Update stats
            updateStats();
        }
        
        // Update monthly progress
        function updateMonthProgress() {
            // Count completed readings in the current month
            let totalMonthReadings = 0;
            let completedMonthReadings = 0;
            
            Object.keys(readingPlan).forEach(date => {
                const day = readingPlan[date];
                const dateObj = new Date(date);
                if (dateObj.getMonth() === currentMonth && dateObj.getFullYear() === currentYear) {
                    totalMonthReadings += day.readings.length;
                    completedMonthReadings += day.readings.filter(reading => reading.completed).length;
                }
            });
            
            // Update progress bar
            const progressPercentage = totalMonthReadings > 0 ? 
                (completedMonthReadings / totalMonthReadings) * 100 : 0;
            
            document.querySelector('.month-progress-fill').style.width = `${progressPercentage}%`;
            
            // Update text
            const monthTitle = document.querySelector('.month-progress-title');
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                                'July', 'August', 'September', 'October', 'November', 'December'];
            monthTitle.textContent = `${monthNames[currentMonth]} Progress`;
            
            // Update stats
            document.querySelector('.month-completed').textContent = 
                `${completedMonthReadings} readings completed`;
            
            document.querySelector('.month-total').textContent = 
                `${completedMonthReadings} of ${totalMonthReadings} readings (${Math.round(progressPercentage)}%)`;
        }
        
        // Render the reading cards
        function renderReadings(containerId, date) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            const dayData = readingPlan[date];
            
            if (!dayData) {
                container.innerHTML = '<div class="no-readings">No readings available for this date yet.</div>';
                return;
            }
            
            dayData.readings.forEach((reading, index) => {
                const card = document.createElement('div');
                card.className = `reading-card${reading.completed ? ' completed' : ''}`;
                
                card.innerHTML = `
                    <div class="reading-content">
                        <div class="reading-left">
                            <div class="reading-icon">
                                <i class="fas fa-${reading.icon}"></i>
                            </div>
                            <div class="reading-text">
                                <div class="reading-title">${reading.title}</div>
                                <div class="reading-reference">${reading.reference}</div>
                                <div class="reading-time">${reading.time} reading time</div>
                            </div>
                        </div>
                        <div class="reading-checkbox${reading.completed ? ' checked' : ''}" onclick="toggleReadingComplete(${index}, '${containerId}')">
                            ${reading.completed ? '<i class="fas fa-check"></i>' : ''}
                        </div>
                    </div>
                    <div class="reading-actions">
                        <button class="btn btn-primary" onclick="openReading(${index}, '${date}')">Read Now</button>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }
        
        // Toggle reading completion
        function toggleReadingComplete(index, containerId) {
            const date = containerId === 'calendar-reading-container' ? 
                document.querySelector('#calendar-date-title').textContent : currentDate;
                
            // Find the date key from the date string
            const dateKey = containerId === 'calendar-reading-container' ? 
                getDateKeyFromString(date) : currentDate;
            
            if (!readingPlan[dateKey]) return;
            
            // Toggle completion
            readingPlan[dateKey].readings[index].completed = !readingPlan[dateKey].readings[index].completed;
            
            // Save to local storage
            saveReadingProgress();
            
            // Re-render the readings
            renderReadings(containerId, dateKey);
            
            // Update progress if on home screen
            if (containerId === 'reading-container' || dateKey === currentDate) {
                updateProgress();
            }
            
            // Update monthly progress display
            updateMonthProgress();
            
            // Update calendar display
            renderCalendar();
        }
        
        // Extract date key from a date string
        function getDateKeyFromString(dateString) {
            // Sample input: "Monday, March 17, 2025"
            // Expected output: "2025-03-17"
            
            // Find the matching date in the reading plan
            for (const dateKey in readingPlan) {
                if (readingPlan[dateKey].date === dateString) {
                    return dateKey;
                }
            }
            
            return null;
        }
        
        // Open a reading in the Bible reader
        function openReading(index, date) {
            currentReadingIndex = index;
            
            const reading = readingPlan[date].readings[index];
            
            // Set the reader title
            document.getElementById('reader-title').textContent = reading.reference;
            
            // Parse the reference to display content - normally would fetch from Bible API
            const content = getScriptureContent(reading.reference);
            
            // Load the content
            document.getElementById('reader-content').innerHTML = content;
            
            // Show the reader screen
            showScreen('reader-screen');
        }
        
        // Generate scripture content - in a real app, this would be fetched from a Bible API
        function getScriptureContent(reference) {
            // Extract book and chapter from reference
            const bookChapterMatch = reference.match(/([1-3]?\s?[A-Za-z]+)\s+(\d+)/);
            
            if (!bookChapterMatch) return '<div class="verse-wrapper">Scripture content unavailable.</div>';
            
            const bookChapter = `${bookChapterMatch[1]} ${bookChapterMatch[2]}`;
            
            // Check if we have sample verses for this book/chapter
            if (!sampleVerses[bookChapter]) {
                return `
                    <div class="chapter-number">${bookChapterMatch[2]}</div>
                    <div class="verse-wrapper">
                        <span class="verse-text">In a production app, this would fetch the actual scripture content from a Bible API for ${reference}.</span>
                    </div>
                `;
            }
            
            // Build verses HTML from our sample data
            let versesHtml = `<div class="chapter-number">${bookChapterMatch[2]}</div>`;
            
            sampleVerses[bookChapter].forEach(verse => {
                versesHtml += `
                    <div class="verse-wrapper">
                        <span class="verse-number">${verse.number}</span>
                        <span class="verse-text">${verse.text}</span>
                    </div>
                `;
            });
            
            return versesHtml;
        }
        
        // Open external Bible application or website
        function openExternalBible() {
            const reading = readingPlan[currentDate].readings[currentReadingIndex];
            const reference = encodeURIComponent(reading.reference);
            
            // Open YouVersion or Bible Gateway - this is just an example
            window.open(`https://www.bible.com/bible/1/${reference}`, '_blank');
        }
        
        // Mark reading complete from reader screen
        function markReaderComplete() {
            if (currentReadingIndex >= 0) {
                readingPlan[currentDate].readings[currentReadingIndex].completed = true;
                
                // Save to local storage
                saveReadingProgress();
                
                showScreen('home-screen');
                renderReadings('reading-container', currentDate);
                updateProgress();
                updateMonthProgress();
                
                // Update calendar display
                renderCalendar();
            }
        }
        
        // Change the current date from dropdown
        function changeDate() {
            currentDate = document.getElementById('day-selector').value;
            
            // Re-render the readings
            renderReadings('reading-container', currentDate);
            
            // Update progress
            updateProgress();
        }
        
        // Generate calendar
        function renderCalendar() {
            const grid = document.getElementById('calendar-grid');
            grid.innerHTML = '';
            
            // Add day headers
            const daysOfWeek = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];
            daysOfWeek.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-day-header';
                dayHeader.textContent = day;
                grid.appendChild(dayHeader);
            });
            
            // Get the first day of the month and total days
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            // Get days from previous month
            const daysInPrevMonth = new Date(currentYear, currentMonth, 0).getDate();
            
            // Add previous month days
            for (let i = firstDay - 1; i >= 0; i--) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day inactive-month';
                dayElement.textContent = daysInPrevMonth - i;
                grid.appendChild(dayElement);
            }
            
            // Add current month days
            for (let i = 1; i <= daysInMonth; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day active-month';
                
                // Format date string for lookup
                const dateStr = formatDateKey(currentYear, currentMonth, i);
                
                // Add today/selected/completed classes
                if (dateStr === currentDate) {
                    dayElement.classList.add('selected');
                }
                
                const status = getDayStatus(dateStr);
                if (status === 'completed') {
                    dayElement.classList.add('completed');
                } else if (status === 'partial') {
                    dayElement.classList.add('partial');
                }
                
                dayElement.textContent = i;
                dayElement.onclick = () => selectCalendarDay(dateStr);
                grid.appendChild(dayElement);
            }
            
            // Add next month days to fill grid
            const totalCells = 42; // 6 rows of 7 days
            const remainingCells = totalCells - (firstDay + daysInMonth);
            
            for (let i = 1; i <= remainingCells; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day inactive-month';
                dayElement.textContent = i;
                grid.appendChild(dayElement);
            }
            
            // Update month title
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                               'July', 'August', 'September', 'October', 'November', 'December'];
            document.getElementById('calendar-month-title').textContent = `${monthNames[currentMonth]} ${currentYear}`;
        }
        
        // Format date as YYYY-MM-DD
        function formatDateKey(year, month, day) {
            return `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        }
        
        // Get day completion status (for calendar)
        function getDayStatus(dateStr) {
            if (!readingPlan[dateStr]) return 'none';
            
            const readings = readingPlan[dateStr].readings;
            const completedCount = readings.filter(reading => reading.completed).length;
            
            if (completedCount === 0) return 'none';
            if (completedCount === readings.length) return 'completed';
            return 'partial';
        }
        
        // Select a day from the calendar
        function selectCalendarDay(dateStr) {
            // Update current date
            currentDate = dateStr;
            
            // Update calendar-date-title
            document.getElementById('calendar-date-title').textContent = readingPlan[dateStr] ? 
                readingPlan[dateStr].date : formatDateFromKey(dateStr);
            
            // Update day selector
            document.getElementById('day-selector').value = dateStr;
            
            // Render readings for this day
            renderReadings('calendar-reading-container', dateStr);
            renderReadings('reading-container', dateStr);
            
            // Update progress
            updateProgress();
            
            // Re-render calendar to show selection
            renderCalendar();
        }
        
        // Format a date key (YYYY-MM-DD) to readable date
        function formatDateFromKey(dateKey) {
            const [year, month, day] = dateKey.split('-');
            const date = new Date(year, month - 1, day);
            return formatDate(date);
        }
        
        // Change month in calendar
        function changeMonth(delta) {
            currentMonth += delta;
            
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            } else if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            
            renderCalendar();
        }
        
        // Show a specific screen
        function showScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show selected screen
            document.getElementById(screenId).classList.add('active');
            
            // Update bottom nav
            if (['home-screen', 'calendar-screen', 'settings-screen'].includes(screenId)) {
                updateBottomNav(screenId);
            }
            
            // Initialize calendar if showing calendar screen
            if (screenId === 'calendar-screen') {
                // Render calendar readings
                renderReadings('calendar-reading-container', currentDate);
                
                // Update calendar title
                document.getElementById('calendar-date-title').textContent = readingPlan[currentDate] ? 
                    readingPlan[currentDate].date : formatDateFromKey(currentDate);
            }
        }
        
        // Update bottom navigation active state
        function updateBottomNav(activeScreenId) {
            // Remove active class from all nav items
            document.querySelectorAll('.bottom-nav .nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to the corresponding nav item
            let navIndex = 0;
            
            switch(activeScreenId) {
                case 'home-screen': navIndex = 0; break;
                case 'calendar-screen': navIndex = 1; break;
                case 'settings-screen': navIndex = 2; break;
                default: navIndex = 0;
            }
            
            const navItems = document.querySelectorAll('.bottom-nav .nav-item');
            if (navItems[navIndex]) {
                navItems[navIndex].classList.add('active');
            }
        }
        
        // Update user statistics
        function updateStats() {
            // Calculate streak
            let streak = 0;
            const today = new Date();
            for (let i = 0; i < 365; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateKey = formatDateKey(date.getFullYear(), date.getMonth(), date.getDate());
                
                if (!readingPlan[dateKey]) break;
                
                const readings = readingPlan[dateKey].readings;
                const allCompleted = readings.every(reading => reading.completed);
                
                if (allCompleted) {
                    streak++;
                } else {
                    break;
                }
            }
            
            // Count total readings completed
            let totalReadings = 0;
            let completedDays = 0;
            
            Object.keys(readingPlan).forEach(date => {
                const readings = readingPlan[date].readings;
                const completedReadings = readings.filter(reading => reading.completed).length;
                totalReadings += completedReadings;
                
                if (completedReadings === readings.length) {
                    completedDays++;
                }
            });
            
            // Update stats
            userStats.streak = streak;
            userStats.totalReadings = totalReadings;
            userStats.completedDays = completedDays;
            
            // Update display
            document.getElementById('streak-count').textContent = streak;
            document.getElementById('total-readings').textContent = totalReadings;
            document.getElementById('completed-days').textContent = completedDays;
        }
        
        // Storage system with fallback for environments where localStorage isn't available
        const storage = {
            // In-memory fallback storage
            memoryStorage: {
                readingProgress: null,
                userSettings: null
            },
            
            // Check if localStorage is available
            isLocalStorageAvailable() {
                try {
                    const testKey = '__test__';
                    localStorage.setItem(testKey, testKey);
                    localStorage.removeItem(testKey);
                    return true;
                } catch (e) {
                    return false;
                }
            },
            
            // Save data with fallback
            saveItem(key, data) {
                try {
                    if (this.isLocalStorageAvailable()) {
                        localStorage.setItem(key, JSON.stringify(data));
                    } else {
                        this.memoryStorage[key] = data;
                        console.log(`Saved data to memory storage: ${key}`);
                    }
                    return true;
                } catch (error) {
                    console.error(`Error saving ${key}:`, error);
                    this.memoryStorage[key] = data;
                    return false;
                }
            },
            
            // Load data with fallback
            loadItem(key) {
                try {
                    if (this.isLocalStorageAvailable()) {
                        const item = localStorage.getItem(key);
                        return item ? JSON.parse(item) : null;
                    } else {
                        console.log(`Loaded data from memory storage: ${key}`);
                        return this.memoryStorage[key];
                    }
                } catch (error) {
                    console.error(`Error loading ${key}:`, error);
                    return this.memoryStorage[key];
                }
            }
        };
        
        // Save reading progress
        function saveReadingProgress() {
            const planData = {};
            
            // Only save completion status to keep storage size reasonable
            Object.keys(readingPlan).forEach(date => {
                planData[date] = {
                    readings: readingPlan[date].readings.map(reading => ({
                        completed: reading.completed
                    }))
                };
            });
            
            storage.saveItem('readingProgress', planData);
        }
        
        // Load reading progress
        function loadReadingProgress() {
            const planData = storage.loadItem('readingProgress');
            
            if (planData) {
                // Apply saved completion status
                Object.keys(planData).forEach(date => {
                    if (readingPlan[date]) {
                        readingPlan[date].readings.forEach((reading, index) => {
                            if (planData[date].readings[index]) {
                                reading.completed = planData[date].readings[index].completed;
                            }
                        });
                    }
                });
            }
        }
        
        // Save user profile
        function saveUserProfile() {
            userSettings.name = document.getElementById('display-name-input').value || 'Reader';
            
            const success = storage.saveItem('userSettings', userSettings);
            
            // Update UI
            updateUserDisplay();
            
            if (success) {
                alert('Profile saved successfully!');
            } else {
                alert('Profile saved in memory only. Will be lost when page refreshes.');
            }
        }
        
        // Load user profile
        function loadUserProfile() {
            const savedSettings = storage.loadItem('userSettings');
            
            if (savedSettings) {
                userSettings = {...userSettings, ...savedSettings};
            }
            
            // Load reading progress
            loadReadingProgress();
            
            // Update UI
            updateUserDisplay();
            
            // Restore form values
            document.getElementById('display-name-input').value = userSettings.name;
            document.getElementById('notifications-toggle').checked = userSettings.notificationsEnabled;
            document.getElementById('reminder-time').value = userSettings.reminderTime;
            document.getElementById('dark-mode-toggle').checked = userSettings.darkMode;
            document.getElementById('text-size-selector').value = userSettings.textSize;
        }
        
        // Update user display across screens
        function updateUserDisplay() {
            const initial = userSettings.name.charAt(0).toUpperCase();
            
            document.getElementById('user-name-display').textContent = userSettings.name;
            document.getElementById('user-avatar').textContent = initial;
            document.getElementById('calendar-user-avatar').textContent = initial;
            document.getElementById('settings-user-avatar').textContent = initial;
        }
        
        // Save notification settings
        function saveReminderSettings() {
            userSettings.notificationsEnabled = document.getElementById('notifications-toggle').checked;
            userSettings.reminderTime = document.getElementById('reminder-time').value;
            
            localStorage.setItem('bible-reader-user', JSON.stringify(userSettings));
            
            alert('Reminder settings saved!');
        }
        
        // Reset all reading progress
        function resetProgress() {
            if (confirm('Are you sure you want to reset all your reading progress? This cannot be undone.')) {
                // Reset all readings to incomplete
                Object.keys(readingPlan).forEach(date => {
                    readingPlan[date].readings.forEach(reading => {
                        reading.completed = false;
                    });
                });
                
                // Save progress
                saveReadingProgress();
                
                // Update UI
                renderReadings('reading-container', currentDate);
                renderCalendar();
                updateProgress();
                updateMonthProgress();
                
                alert('Reading progress has been reset.');
            }
        }
        
        // Add notification about storage limitations if localStorage isn't available
        document.addEventListener('DOMContentLoaded', function() {
            // Add rest of initialization
            if (!storage.isLocalStorageAvailable()) {
                // Create notification banner
                const banner = document.createElement('div');
                banner.style.backgroundColor = '#FFF3CD';
                banner.style.color = '#856404';
                banner.style.padding = '10px 16px';
                banner.style.marginBottom = '16px';
                banner.style.borderRadius = '4px';
                banner.style.fontSize = '14px';
                banner.style.textAlign = 'center';
                banner.innerHTML = '<strong>Notice:</strong> Your progress will only be saved for this session. For full functionality, please use this app on a normal web server.';
                
                // Insert at top of main content areas
                const mainContents = document.querySelectorAll('.main-content');
                mainContents.forEach(content => {
                    content.insertBefore(banner.cloneNode(true), content.firstChild);
                });
            }
        });
    </script>
</body>
</html>
